import{j as e}from"./index-CvPcnR5S.js";import{r as a}from"./vendor-IDWrQIHz.js";import{u as H}from"./appStore-BPO_w7dw.js";import"./state-MjgzQ4RD.js";function W(){const{tasks:u,taskLoading:P,totalPages:h,fetchTasks:b,createTask:A,updateTask:y,deleteTask:M}=H(),[$,i]=a.useState(!1),[o,S]=a.useState(null),[n,l]=a.useState(0),[c,E]=a.useState(""),[d,L]=a.useState(""),[p,I]=a.useState("createdAt"),[C,m]=a.useState(""),[f,x]=a.useState(""),[T,j]=a.useState("medium"),[D,v]=a.useState("todo"),[g,N]=a.useState("");a.useEffect(()=>{b({page:n,size:20,...c&&{status:c},...d&&{priority:d},sortBy:p,sortDirection:"desc"})},[b,n,c,d,p]);const k=()=>{S(null),m(""),x(""),j("medium"),v("todo"),N(""),i(!0)},F=s=>{S(s),m(s.title),x(s.description||""),j(s.priority),v(s.status),N(s.deadline?s.deadline.slice(0,10):""),i(!0)},O=async s=>{s.preventDefault();const t={title:C,description:f,priority:T,status:D};g?t.deadline=new Date(g+"T23:59:59").toISOString():t.deadline=null,o?await y(o.id,t):await A(t),i(!1)},B=async s=>{const t=s.status==="done"?"todo":"done";await y(s.id,{...s,status:t})};return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Tasks"}),e.jsx("p",{className:"page-subtitle",children:"Manage your tasks efficiently"})]}),e.jsx("button",{className:"btn btn-primary",onClick:k,children:"+ New Task"})]}),e.jsxs("div",{className:"filter-bar",children:[e.jsxs("select",{className:"input",value:c,onChange:s=>{E(s.target.value),l(0)},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"todo",children:"To Do"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"done",children:"Done"})]}),e.jsxs("select",{className:"input",value:d,onChange:s=>{L(s.target.value),l(0)},children:[e.jsx("option",{value:"",children:"All Priority"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]}),e.jsxs("select",{className:"input",value:p,onChange:s=>I(s.target.value),children:[e.jsx("option",{value:"createdAt",children:"Date Created"}),e.jsx("option",{value:"deadline",children:"Deadline"}),e.jsx("option",{value:"priority",children:"Priority"})]})]}),P&&!u.length?e.jsx("div",{className:"loader",children:e.jsx("div",{className:"spinner"})}):u.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"task-list",children:u.map(s=>e.jsxs("div",{className:"task-item",children:[e.jsx("button",{className:`task-checkbox ${s.status==="done"?"checked":""}`,onClick:()=>B(s),children:s.status==="done"?"âœ“":""}),e.jsxs("div",{className:"task-info",children:[e.jsx("div",{className:`task-title ${s.status==="done"?"completed":""}`,children:s.title}),e.jsxs("div",{className:"task-meta",children:[e.jsx("span",{className:`badge badge-${s.priority}`,children:s.priority}),e.jsx("span",{className:`badge badge-${s.status}`,children:s.status}),s.deadline&&(()=>{const t=new Date(s.deadline),r=Math.ceil((t.getTime()-Date.now())/(1e3*60*60*24)),w=r<0;return e.jsxs("span",{style:{color:w?"var(--accent-critical)":r<=2?"var(--accent-warning)":"var(--text-muted)"},children:["ðŸ“… ",t.toLocaleDateString("en-US",{month:"short",day:"numeric"}),w?` (${Math.abs(r)}d overdue)`:r===0?" (today)":` (${r}d left)`]})})()]})]}),e.jsxs("div",{className:"task-actions",children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>F(s),children:"âœï¸"}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>M(s.id),children:"ðŸ—‘ï¸"})]})]},s.id))}),h>1&&e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"pagination-btn",disabled:n===0,onClick:()=>l(s=>s-1),children:"â†  Prev"}),Array.from({length:h},(s,t)=>e.jsx("button",{className:`pagination-btn ${n===t?"active":""}`,onClick:()=>l(t),children:t+1},t)),e.jsx("button",{className:"pagination-btn",disabled:n>=h-1,onClick:()=>l(s=>s+1),children:"Next  â†’"})]})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“"}),e.jsx("h3",{children:"No tasks yet"}),e.jsx("p",{children:"Create your first task to get started"}),e.jsx("button",{className:"btn btn-primary",style:{marginTop:"var(--space-4)"},onClick:k,children:"+ Create Task"})]}),$&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"modal-title",children:o?"Edit Task":"New Task"}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Title"}),e.jsx("input",{className:"input",value:C,onChange:s=>m(s.target.value),required:!0,placeholder:"What needs to be done?"})]}),e.jsxs("div",{className:"input-group",style:{marginTop:"var(--space-4)"},children:[e.jsx("label",{className:"input-label",children:"Description"}),e.jsx("textarea",{className:"input",value:f,onChange:s=>x(s.target.value),placeholder:"Add details..."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--space-4)",marginTop:"var(--space-4)"},children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Priority"}),e.jsxs("select",{className:"input",value:T,onChange:s=>j(s.target.value),children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Status"}),e.jsxs("select",{className:"input",value:D,onChange:s=>v(s.target.value),children:[e.jsx("option",{value:"todo",children:"To Do"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"done",children:"Done"})]})]})]}),e.jsxs("div",{className:"input-group",style:{marginTop:"var(--space-4)"},children:[e.jsx("label",{className:"input-label",children:"Deadline"}),e.jsx("input",{type:"date",className:"input",value:g,onChange:s=>N(s.target.value),min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:o?"Save Changes":"Create Task"})]})]})]})})]})}export{W as Tasks};
