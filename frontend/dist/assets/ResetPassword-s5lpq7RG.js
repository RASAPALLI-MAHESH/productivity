import{u as b,j as e}from"./index-CvPcnR5S.js";import{r as n,u as j}from"./vendor-IDWrQIHz.js";import"./state-MjgzQ4RD.js";function y(r){let s=0;return r.length>=8&&s++,r.length>=12&&s++,/[A-Z]/.test(r)&&s++,/[0-9]/.test(r)&&s++,/[^A-Za-z0-9]/.test(r)&&s++,s<=1?{score:s,label:"Weak",color:"var(--critical)"}:s<=2?{score:s,label:"Fair",color:"var(--warning)"}:s<=3?{score:s,label:"Good",color:"var(--accent)"}:{score:s,label:"Strong",color:"var(--success)"}}function C(){const[r,s]=n.useState(""),[i,h]=n.useState(""),[a,m]=n.useState(!1),[c,w]=n.useState(!1),{resetPassword:g,loading:d,error:u,clearError:x,authStep:v}=b(),p=j(),o=n.useMemo(()=>y(r),[r]),l=i===""||r===i;if(v!=="reset-password"&&!c)return p("/forgot-password"),null;const f=async t=>{if(t.preventDefault(),x(),r===i)try{await g(r),w(!0)}catch{}};return c?e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",style:{maxWidth:440,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3.5rem",marginBottom:"var(--space-4)",animation:"bounceIn 500ms cubic-bezier(0.16, 1, 0.3, 1)"},children:"âœ…"}),e.jsx("h1",{children:"Password reset!"}),e.jsx("p",{children:"Your password has been updated successfully. You can now sign in with your new password."}),e.jsx("button",{className:"btn btn-primary btn-lg",onClick:()=>p("/login"),style:{marginTop:"var(--space-6)",width:"100%"},children:"Go to Sign In"})]})}):e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",style:{maxWidth:440,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3.5rem",marginBottom:"var(--space-4)"},children:"ðŸ”’"}),e.jsx("h1",{children:"Set new password"}),e.jsx("p",{children:"Choose a strong password to secure your account"}),u&&e.jsx("div",{className:"auth-error",children:u}),e.jsxs("form",{onSubmit:f,style:{textAlign:"left",marginTop:"var(--space-6)"},children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{id:"newPassword",type:a?"text":"password",className:"input",placeholder:"Min 8 characters",value:r,onChange:t=>s(t.target.value),required:!0,minLength:8,autoComplete:"new-password",autoFocus:!0,style:{paddingRight:48}}),e.jsx("button",{type:"button",onClick:()=>m(!a),className:"password-toggle","aria-label":a?"Hide password":"Show password",children:a?"ðŸ™ˆ":"ðŸ‘ï¸"})]}),r&&e.jsxs("div",{style:{marginTop:"var(--space-2)"},children:[e.jsx("div",{style:{display:"flex",gap:4,marginBottom:4},children:[1,2,3,4,5].map(t=>e.jsx("div",{style:{flex:1,height:3,borderRadius:"var(--radius-full)",background:t<=o.score?o.color:"var(--border)",transition:"all 200ms ease"}},t))}),e.jsx("span",{style:{fontSize:"var(--font-size-xs)",color:o.color},children:o.label})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",htmlFor:"confirmNewPassword",children:"Confirm Password"}),e.jsx("input",{id:"confirmNewPassword",type:a?"text":"password",className:"input",placeholder:"Re-enter new password",value:i,onChange:t=>h(t.target.value),required:!0,autoComplete:"new-password",style:{borderColor:l?void 0:"var(--critical)"}}),!l&&e.jsx("span",{style:{fontSize:"var(--font-size-xs)",color:"var(--critical)",marginTop:"var(--space-1)"},children:"Passwords do not match"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:d||!l||o.score<2,style:{marginTop:"var(--space-2)"},children:d?"Resetting...":"Reset Password"})]})]})})}export{C as ResetPassword};
