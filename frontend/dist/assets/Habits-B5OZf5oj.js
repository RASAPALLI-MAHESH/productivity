import{j as e}from"./index-CvPcnR5S.js";import{r as i}from"./vendor-IDWrQIHz.js";import{u as k}from"./appStore-BPO_w7dw.js";import"./state-MjgzQ4RD.js";function B(){const{habits:r,habitLoading:j,habitLogs:b,fetchHabits:d,createHabit:v,deleteHabit:g,completeHabit:y,fetchHabitLogs:m}=k(),[N,n]=i.useState(!1),[p,h]=i.useState(""),[u,x]=i.useState(""),[l,f]=i.useState(null);i.useEffect(()=>{d()},[d]),i.useEffect(()=>{if(l){const s=new Date().toISOString().split("T")[0],t=new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0];m(l,t,s)}},[l,m]);const S=async s=>{s.preventDefault(),await v({name:p,description:u}),h(""),x(""),n(!1)},c=new Date().toISOString().split("T")[0],C=(()=>{const s=[];for(let t=27;t>=0;t--){const o=new Date(Date.now()-t*24*60*60*1e3);s.push(o.toISOString().split("T")[0])}return s})();return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Habits"}),e.jsx("p",{className:"page-subtitle",children:"Build consistency, track your streaks"})]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>n(!0),children:"+ New Habit"})]}),j&&!r.length?e.jsx("div",{className:"loader",children:e.jsx("div",{className:"spinner"})}):r.length?e.jsx("div",{className:"habit-grid",children:r.map(s=>{const t=s.lastCompletedDate===c,o=b[s.id]||[],D=new Set(o.filter(a=>a.completed).map(a=>a.date));return e.jsxs("div",{className:"habit-card",children:[e.jsxs("div",{className:"habit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"habit-name",children:s.name}),s.description&&e.jsx("div",{style:{fontSize:"var(--font-size-xs)",color:"var(--text-muted)",marginTop:"var(--space-1)"},children:s.description})]}),e.jsxs("div",{className:"habit-streak",children:["ðŸ”¥ ",s.currentStreak]})]}),e.jsxs("div",{style:{display:"flex",gap:"var(--space-4)",marginBottom:"var(--space-4)",fontSize:"var(--font-size-xs)",color:"var(--text-secondary)"},children:[e.jsxs("span",{children:["Best: ",s.longestStreak," days"]}),e.jsxs("span",{children:["Current: ",s.currentStreak," days"]})]}),e.jsx("div",{className:"heatmap",style:{cursor:"pointer"},onClick:()=>f(l===s.id?null:s.id),children:C.map(a=>e.jsx("div",{className:`heatmap-cell ${D.has(a)||t&&a===c?"active":""} ${a===c?"today":""}`,title:a},a))}),e.jsx("button",{className:`habit-complete-btn ${t?"completed":""}`,onClick:()=>!t&&y(s.id),disabled:t,style:{marginTop:"var(--space-4)"},children:t?"âœ“ Done today":"â—‹ Mark complete"}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"var(--space-3)"},children:e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>g(s.id),children:"ðŸ—‘ï¸ Delete"})})]},s.id)})}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ’ª"}),e.jsx("h3",{children:"Build momentum"}),e.jsx("p",{children:"Start with one small daily habit. Consistency beats intensity."}),e.jsx("button",{className:"btn btn-primary",style:{marginTop:"var(--space-4)"},onClick:()=>n(!0),children:"+ Create your first habit"})]}),N&&e.jsx("div",{className:"modal-overlay",onClick:()=>n(!1),children:e.jsxs("div",{className:"modal",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"modal-title",children:"New Habit"}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Habit Name"}),e.jsx("input",{className:"input",value:p,onChange:s=>h(s.target.value),required:!0,placeholder:"e.g., Read 30 minutes"})]}),e.jsxs("div",{className:"input-group",style:{marginTop:"var(--space-4)"},children:[e.jsx("label",{className:"input-label",children:"Description (optional)"}),e.jsx("textarea",{className:"input",value:u,onChange:s=>x(s.target.value),placeholder:"Why is this habit important?"})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Create Habit"})]})]})]})})]})}export{B as Habits};
